---
// Header.astro v1.7.2 - SAUBERE User Choice Integration (basiert auf v1.5.2)
// CHANGELOG v1.7.2:
// - 🔧 BASE: Header v1.5.2 als saubere Grundlage 
// - ✅ ADD: User Choice Toggle Button (OHNE Duplikate)
// - ✅ KEEP: Bestehende Theme Toggle Logik unverändert
// - ✅ KEEP: Alle Navigation und Mobile Menu Features
// - 🔧 FIX: Nur EIN User Choice Toggle pro Bereich (Desktop/Mobile)

console.log('🎨 Header v1.7.1 - SAUBERE User Choice Integration');
---

<header class="bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border-b border-gray-200 dark:border-gray-700 fixed w-full top-0 z-50 transition-all duration-300">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between h-16 lg:h-20">
      <!-- Logo -->
      <div class="flex items-center">
        <a href="/" class="flex items-center space-x-3 hover:opacity-80 transition-opacity">
          <!-- KORREKTES LOGO VOM FOOTER -->
          <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 lg:w-12 lg:h-12" viewBox="0 0 1778 1433">
            <path fill="#D2AE6C" d="M1346.536,147.84C1241.455,252.922,1136.736,357.643,1031.126,463.254C926.022,358.15,821.475,253.602,716.82,148.947C716.82,203.569,716.82,258.414,716.82,313.896C713.113,309.612,709.955,305.872,706.703,302.216C693.015,286.826,679.3,271.461,665.594,256.087C651.889,240.714,638.182,225.341,624.476,209.968C613.511,197.669,602.537,185.378,591.583,173.07C578.221,158.058,564.882,143.026,551.521,128.015C540.566,115.707,529.59,103.418,518.625,91.119C504.919,75.746,491.251,60.338,477.497,45.009C464.938,31.012,452.279,17.106,439.705,3.124C439.248,2.616,439.225,1.717,439.000,1.000C437.889,1.000,437.444,1.000,437,1.469C437,323.54,437,645.144,437,967C439.472,967,441.286,967,443.1,967C527.43,967,611.761,967.18,696.089,966.822C710.137,966.763,724.228,964.769,738.205,962.948C760.242,960.076,781.202,953.138,801.419,944.109C834.312,929.417,863.347,909.257,887.929,882.712C898.875,870.892,908.721,858.354,917.675,844.968C934.006,820.556,945.575,794.075,953.544,765.921C958.579,748.137,962.186,729.968,962.741,711.568C963.274,693.915,962.362,676.134,960.765,658.529C959.655,646.293,957.024,634.068,953.82,622.176C946.982,596.801,936.304,573.058,922.406,550.641C906.631,525.195,885.842,503.979,866.225,481.746C860.114,474.82,853.814,468.062,847.685,461.152C835.121,446.989,822.642,432.751,810.072,418.594C803.719,411.438,797.2,404.429,790.841,397.279C788.065,394.159,786.795,390.692,786.863,386.193C787.174,365.532,786.996,344.863,787.009,324.198C787.01,322.633,787.137,321.068,787.206,319.503C787.828,319.038,788.45,318.573,789.072,318.108C928.428,457.463,1067.783,596.819,1206.904,735.939C1206.807,736.29,1206.964,735.984,1206.965,735.679C1206.984,703.847,1207.045,672.014,1206.867,640.183C1206.856,638.253,1205.32,635.948,1203.843,634.465C1164.791,595.267,1125.659,556.15,1086.512,517.048C1085.021,515.56,1083.236,514.366,1082.683,513.919C1147.624,448.977,1211.974,384.625,1276.126,320.471C1276.126,535.349,1276.126,750.942,1276.126,966.733C1299.839,966.733,1323.23,966.733,1346.536,966.733C1346.536,693.677,1346.536,420.888,1346.536,147.84ZM557.5,896C540.532,896,524.563,896,508.298,896C508.298,659.685,508.298,423.687,508.298,187.253C514.828,194.314,521.223,201.047,527.408,207.968C533.978,215.32,540.294,222.899,546.816,230.294C559.777,244.989,572.794,259.634,585.807,274.283C591.498,280.69,597.249,287.043,602.947,293.444C616.308,308.452,629.613,323.509,643.021,338.474C650.293,346.592,657.83,354.474,665.07,362.619C677.093,376.145,688.917,389.847,700.931,403.381C710.238,413.864,719.783,424.137,729.086,434.624C740.985,448.038,752.712,461.603,764.582,475.043C770.805,482.09,777.214,488.972,783.468,495.991C796.614,510.744,809.715,525.537,822.831,540.317C830.701,549.185,838.73,557.918,846.394,566.961C860.957,584.143,872.228,603.446,879.606,624.62C884.543,638.787,888.677,653.549,890.562,668.376C892.42,682.996,891.345,698.044,890.917,712.885C890.423,729.964,885.796,746.269,880.002,762.23C872.064,784.095,860.843,804.09,846.296,822.313C831.898,840.35,814.712,855.172,795.173,867.156C776.669,878.505,756.706,886.425,735.376,891.178C718.368,894.968,701.308,896.149,683.977,896.066C641.819,895.864,599.659,896,557.5,896Z" />
          </svg>
          <div class="hidden sm:block">
            <div class="text-xl lg:text-2xl font-bold text-gray-900 dark:text-white">
              Dominik Maier
            </div>
            <div class="text-sm text-gray-600 dark:text-gray-300">
              Business Consulting
            </div>
          </div>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <nav class="hidden lg:flex items-center space-x-8">
        <a href="/" class="text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
          Start
        </a>
        
        <!-- Desktop Services Dropdown -->
        <div class="relative group">
          <button class="flex items-center text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
            Leistungen
            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>
          <div class="absolute top-full left-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10">
            <div class="py-2">
              <a href="/strategische-unternehmensentwicklung" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-gold">
                Strategische Unternehmensentwicklung
              </a>
              <a href="/vertriebsoptimierung" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-gold">
                Vertriebsoptimierung
              </a>
              <a href="/marketing-strategien" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-gold">
                Marketing Strategien
              </a>
              <a href="/wertanalyse" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-gold">
                Wertanalyse
              </a>
            </div>
          </div>
        </div>

        <a href="/blog" class="text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
          Blog
        </a>
        <a href="#uber-mich" class="text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
          Über mich
        </a>
        <a href="#kontakt" class="text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
          Kontakt
        </a>
      </nav>

      <!-- Desktop Action Buttons -->
      <div class="hidden lg:flex items-center space-x-3">
        <!-- USER CHOICE TOGGLE - Desktop -->
        <button 
          id="user-choice-toggle" 
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Layout-Modus umschalten"
          title="Layout umschalten: Auto/Mobile/Desktop"
        >
          <svg id="user-choice-icon" class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
          </svg>
          <span id="user-choice-text" class="ml-1 text-xs text-gray-700 dark:text-gray-300">Auto</span>
        </button>

        <!-- Theme Toggle Desktop -->
        <button 
          id="theme-toggle"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Toggle dark mode"
        >
          <!-- SONNE für Light Mode -->
          <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
          </svg>
          <!-- MOND für Dark Mode -->
          <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
          </svg>
        </button>

        <!-- LinkedIn Link -->
        <a 
          href="https://www.linkedin.com/in/dominik-maier-22144710a/" 
          target="_blank" 
          rel="noopener noreferrer"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Dominik Maier LinkedIn-Profil öffnen"
        >
          <svg class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"/>
          </svg>
        </a>
      </div>

      <!-- Mobile Action Buttons -->
      <div class="lg:hidden flex items-center space-x-3">
        <!-- USER CHOICE TOGGLE - Mobile -->
        <button 
          id="user-choice-toggle-mobile" 
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Layout-Modus umschalten"
          title="Layout umschalten"
        >
          <svg class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
          </svg>
        </button>

        <!-- Theme Toggle Mobile -->
        <button 
          id="theme-toggle-mobile"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Toggle dark mode"
        >
          <!-- SONNE für Light Mode -->
          <svg id="theme-toggle-light-icon-mobile" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
          </svg>
          <!-- MOND für Dark Mode -->
          <svg id="theme-toggle-dark-icon-mobile" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
          </svg>
        </button>

        <!-- LinkedIn Link Mobile -->
        <a 
          href="https://www.linkedin.com/in/dominik-maier-22144710a/" 
          target="_blank" 
          rel="noopener noreferrer"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Dominik Maier LinkedIn-Profil öffnen"
        >
          <svg class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"/>
          </svg>
        </a>

        <!-- Mobile Menu Button -->
        <button 
          id="mobile-menu-toggle"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Toggle mobile menu"
        >
          <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="lg:hidden hidden border-t border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm">
      <div class="px-4 py-6 space-y-4">
        <!-- Main Navigation Mobile -->
        <nav class="space-y-2">
          <a href="/" class="block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
            Start
          </a>
          
          <!-- Mobile Leistungen Accordion -->
          <div class="border-b border-gray-200 dark:border-gray-700 pb-4 mb-4">
            <button 
              id="mobile-leistungen-toggle"
              class="flex items-center justify-between w-full px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"
            >
              Leistungen
              <svg id="mobile-leistungen-arrow" class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            
            <div id="mobile-leistungen-menu" class="hidden mt-2 ml-4 space-y-2">
              <a href="/strategische-unternehmensentwicklung" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-gold transition-colors rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                Strategische Unternehmensentwicklung
              </a>
              <a href="/vertriebsoptimierung" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-gold transition-colors rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                Vertriebsoptimierung
              </a>
              <a href="/marketing-strategien" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-gold transition-colors rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                Marketing Strategien
              </a>
              <a href="/wertanalyse" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-gold transition-colors rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                Wertanalyse
              </a>
            </div>
          </div>

          <a href="/blog" class="block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
            Blog
          </a>
          <a href="#uber-mich" class="block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
            Über mich
          </a>
          <a href="#kontakt" class="block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
            Kontakt
          </a>
        </nav>
      </div>
    </div>
  </div>
</header>

<style>
  /* USER CHOICE TOGGLE SYSTEM CSS */
  
  /* Force Mobile Mode */
  .force-mobile-mode .hidden.lg\:flex {
    display: none !important;
  }
  
  .force-mobile-mode .lg\:hidden {
    display: flex !important;
  }
  
  .force-mobile-mode .services-desktop-grid,
  .force-mobile-mode .value-desktop-grid,
  .force-mobile-mode .process-desktop-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem !important;
  }

  /* Force Desktop Mode */
  .force-desktop-mode .lg\:hidden {
    display: none !important;
  }
  
  .force-desktop-mode .hidden.lg\:flex {
    display: flex !important;
  }
  
  .force-desktop-mode .services-desktop-grid,
  .force-desktop-mode .value-desktop-grid,
  .force-desktop-mode .process-desktop-grid {
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 2rem !important;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log('🎨 Header v1.7.1 - SAUBERE User Choice Integration');
  
  // === USER CHOICE TOGGLE SYSTEM ===
  const userChoiceToggle = document.getElementById('user-choice-toggle');
  const userChoiceToggleMobile = document.getElementById('user-choice-toggle-mobile');
  const userChoiceIcon = document.getElementById('user-choice-icon');
  const userChoiceText = document.getElementById('user-choice-text');
  
  // User Choice Modi
  const userChoiceModes = ['auto', 'mobile', 'desktop'];
  let currentUserChoice = localStorage.getItem('userChoice') || 'auto';
  
  console.log('🔧 Current User Choice:', currentUserChoice);
  
  // User Choice Icons
  const userChoiceIcons = {
    auto: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>',
    mobile: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>',
    desktop: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>'
  };
  
  function updateUserChoiceUI() {
    if (userChoiceIcon && userChoiceText) {
      userChoiceIcon.innerHTML = userChoiceIcons[currentUserChoice];
      userChoiceText.textContent = currentUserChoice.charAt(0).toUpperCase() + currentUserChoice.slice(1);
    }
    console.log('🎯 User Choice UI updated:', currentUserChoice);
  }
  
  function applyUserChoice() {
    // Alle Classes entfernen
    document.body.classList.remove('force-mobile-mode', 'force-desktop-mode');
    
    // User Choice anwenden
    switch(currentUserChoice) {
      case 'mobile':
        document.body.classList.add('force-mobile-mode');
        console.log('📱 FORCE MOBILE MODE ACTIVATED');
        break;
      case 'desktop':
        document.body.classList.add('force-desktop-mode');
        console.log('🖥️ FORCE DESKTOP MODE ACTIVATED');
        break;
      case 'auto':
      default:
        console.log('🔄 AUTO MODE ACTIVATED (Responsive)');
        break;
    }
    
    updateUserChoiceUI();
  }
  
  function toggleUserChoice() {
    const currentIndex = userChoiceModes.indexOf(currentUserChoice);
    const nextIndex = (currentIndex + 1) % userChoiceModes.length;
    currentUserChoice = userChoiceModes[nextIndex];
    
    localStorage.setItem('userChoice', currentUserChoice);
    console.log('🔄 User Choice Toggle:', currentUserChoice);
    
    applyUserChoice();
    
    // Page Reload für sofortige Anwendung
    setTimeout(() => {
      console.log('🔄 Reloading page for User Choice application...');
      window.location.reload();
    }, 100);
  }
  
  // Event Listeners für User Choice Toggle
  if (userChoiceToggle) {
    userChoiceToggle.addEventListener('click', toggleUserChoice);
  }
  
  if (userChoiceToggleMobile) {
    userChoiceToggleMobile.addEventListener('click', toggleUserChoice);
  }
  
  // Initial User Choice anwenden
  applyUserChoice();
  
  // === MOBILE MENU TOGGLE ===
  const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');
  
  if (mobileMenuToggle && mobileMenu) {
    mobileMenuToggle.addEventListener('click', function() {
      mobileMenu.classList.toggle('hidden');
      console.log('📱 Mobile menu toggled');
    });
  }

  // === MOBILE SERVICES ACCORDION ===
  const mobileLeistungenToggle = document.getElementById('mobile-leistungen-toggle');
  const mobileLeistungenMenu = document.getElementById('mobile-leistungen-menu');
  const mobileLeistungenArrow = document.getElementById('mobile-leistungen-arrow');
  
if (mobileLeistungenToggle && mobileLeistungenMenu && mobileLeistungenArrow) {
  mobileLeistungenToggle.addEventListener('click', function(e) {
    e.preventDefault();
    e.stopPropagation();
    mobileLeistungenMenu.classList.toggle('hidden');
    mobileLeistungenArrow.classList.toggle('rotate-180');
    console.log('📋 Mobile services accordion toggled');
  });
}

  // === THEME TOGGLE SYSTEM ===
  const themeToggle = document.getElementById('theme-toggle');
  const themeToggleMobile = document.getElementById('theme-toggle-mobile');
  const darkIcon = document.getElementById('theme-toggle-dark-icon');
  const lightIcon = document.getElementById('theme-toggle-light-icon');
  const darkIconMobile = document.getElementById('theme-toggle-dark-icon-mobile');
  const lightIconMobile = document.getElementById('theme-toggle-light-icon-mobile');

  function updateThemeIcons() {
    const isDark = document.documentElement.classList.contains('dark');
    console.log('🌙 Theme Icons Update - Dark Mode:', isDark);
    
    if (isDark) {
      darkIcon?.classList.add('hidden');
      lightIcon?.classList.remove('hidden');
      darkIconMobile?.classList.add('hidden');
      lightIconMobile?.classList.remove('hidden');
    } else {
      darkIcon?.classList.remove('hidden');
      lightIcon?.classList.add('hidden');
      darkIconMobile?.classList.remove('hidden');
      lightIconMobile?.classList.add('hidden');
    }
  }

  function toggleTheme() {
    if (document.documentElement.classList.contains('dark')) {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('theme', 'light');
      console.log('☀️ Light Theme Activated');
    } else {
      document.documentElement.classList.add('dark');
      localStorage.setItem('theme', 'dark');
      console.log('🌙 Dark Theme Activated');
    }
    updateThemeIcons();
  }

  // Theme Toggle Event Listeners
  themeToggle?.addEventListener('click', toggleTheme);
  themeToggleMobile?.addEventListener('click', toggleTheme);

  // Initial Theme Icons
  updateThemeIcons();

  console.log('✅ Header v1.7.1 - All systems initialized successfully!');
});
</script>