---
// Header.astro v1.7.1 - SAUBERE User Choice Integration (basiert auf v1.5.2)
// CHANGELOG v1.7.1:
// - 🔧 BASE: Header v1.5.2 als saubere Grundlage 
// - ✅ ADD: User Choice Toggle Button (OHNE Duplikate)
// - ✅ KEEP: Bestehende Theme Toggle Logik unverändert
// - ✅ KEEP: Alle Navigation und Mobile Menu Features
// - 🔧 FIX: Nur EIN User Choice Toggle pro Bereich (Desktop/Mobile)

console.log('🎨 Header v1.7.1 - SAUBERE User Choice Integration');
---

<header class="bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border-b border-gray-200 dark:border-gray-700 fixed w-full top-0 z-50 transition-all duration-300">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between h-16 lg:h-20">
      <!-- Logo -->
      <div class="flex items-center">
        <a href="/" class="flex items-center space-x-3 hover:opacity-80 transition-opacity">
          <!-- KORREKTES LOGO VOM FOOTER -->
<svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 lg:w-12 lg:h-12" viewBox="0 0 1778 1433">
            <path fill="#D2AE6C" d="M1346.536,147.84C1241.455,252.922,1136.736,357.643,1031.126,463.254C926.022,358.15,821.475,253.602,716.82,148.947C716.82,203.569,716.82,258.414,716.82,313.896C713.113,309.612,709.955,305.872,706.703,302.216C693.015,286.826,679.3,271.461,665.594,256.087C651.889,240.714,638.182,225.341,624.476,209.968C613.511,197.669,602.537,185.378,591.583,173.07C578.221,158.058,564.882,143.026,551.521,128.015C540.566,115.707,529.59,103.418,518.625,91.119C504.919,75.746,491.251,60.338,477.497,45.009C464.938,31.012,452.279,17.106,439.705,3.124C439.248,2.616,439.225,1.717,439.000,1.000C437.889,1.000,437.444,1.000,437,1.469C437,323.54,437,645.144,437,967"/>
          </svg>
          <div class="hidden sm:block">
            <div class="text-xl lg:text-2xl font-bold text-gray-900 dark:text-white">
              Dominik Maier
            </div>
            <div class="text-sm text-gray-600 dark:text-gray-300">
              Business Consulting
            </div>
          </div>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <nav class="hidden lg:flex items-center space-x-8">
        <a href="/" class="text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
          Start
        </a>
        
        <!-- Desktop Services Dropdown -->
        <div class="relative group">
          <button class="flex items-center text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
            Leistungen
            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>
          <div class="absolute top-full left-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10">
            <div class="py-2">
              <a href="/strategische-unternehmensentwicklung" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-gold">
                Strategische Unternehmensentwicklung
              </a>
              <a href="/vertriebsoptimierung" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-gold">
                Vertriebsoptimierung
              </a>
              <a href="/marketing-strategien" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-gold">
                Marketing Strategien
              </a>
              <a href="/wertanalyse" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary-gold">
                Wertanalyse
              </a>
            </div>
          </div>
        </div>

        <a href="/blog" class="text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
          Blog
        </a>
        <a href="#uber-mich" class="text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
          Über mich
        </a>
        <a href="#kontakt" class="text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors">
          Kontakt
        </a>
      </nav>

      <!-- Desktop Action Buttons -->
      <div class="hidden lg:flex items-center space-x-3">
        <!-- USER CHOICE TOGGLE - Desktop -->
        <button 
          id="user-choice-toggle" 
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Layout-Modus umschalten"
          title="Layout umschalten: Auto/Mobile/Desktop"
        >
          <svg id="user-choice-icon" class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
          </svg>
          <span id="user-choice-text" class="ml-1 text-xs text-gray-700 dark:text-gray-300">Auto</span>
        </button>

        <!-- Theme Toggle Desktop -->
        <button 
          id="theme-toggle"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Toggle dark mode"
        >
          <!-- SONNE für Light Mode -->
          <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
          </svg>
          <!-- MOND für Dark Mode -->
          <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
          </svg>
        </button>

        <!-- LinkedIn Link -->
        <a 
          href="https://www.linkedin.com/in/dominik-maier-22144710a/" 
          target="_blank" 
          rel="noopener noreferrer"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Dominik Maier LinkedIn-Profil öffnen"
        >
          <svg class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"/>
          </svg>
        </a>
      </div>

      <!-- Mobile Action Buttons -->
      <div class="lg:hidden flex items-center space-x-3">
        <!-- USER CHOICE TOGGLE - Mobile -->
        <button 
          id="user-choice-toggle-mobile" 
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Layout-Modus umschalten"
          title="Layout umschalten"
        >
          <svg class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
          </svg>
        </button>

        <!-- Theme Toggle Mobile -->
        <button 
          id="theme-toggle-mobile"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Toggle dark mode"
        >
          <!-- SONNE für Light Mode -->
          <svg id="theme-toggle-light-icon-mobile" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
          </svg>
          <!-- MOND für Dark Mode -->
          <svg id="theme-toggle-dark-icon-mobile" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
          </svg>
        </button>

        <!-- LinkedIn Link Mobile -->
        <a 
          href="https://www.linkedin.com/in/dominik-maier-22144710a/" 
          target="_blank" 
          rel="noopener noreferrer"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Dominik Maier LinkedIn-Profil öffnen"
        >
          <svg class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"/>
          </svg>
        </a>

        <!-- Mobile Menu Button -->
        <button 
          id="mobile-menu-toggle"
          class="p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          aria-label="Toggle mobile menu"
        >
          <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="lg:hidden hidden border-t border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm">
      <div class="px-4 py-6 space-y-4">
        <!-- Main Navigation Mobile -->
        <nav class="space-y-2">
          <a href="/" class="block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
            Start
          </a>
          
          <!-- Mobile Leistungen Accordion -->
          <div class="border-b border-gray-200 dark:border-gray-700 pb-4 mb-4">
            <button 
              id="mobile-leistungen-toggle"
              class="flex items-center justify-between w-full px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"
            >
              Leistungen
              <svg id="mobile-leistungen-arrow" class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            
            <div id="mobile-leistungen-menu" class="hidden mt-2 ml-4 space-y-2">
              <a href="/strategische-unternehmensentwicklung" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-gold transition-colors rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                Strategische Unternehmensentwicklung
              </a>
              <a href="/vertriebsoptimierung" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-gold transition-colors rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                Vertriebsoptimierung
              </a>
              <a href="/marketing-strategien" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-gold transition-colors rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                Marketing Strategien
              </a>
              <a href="/wertanalyse" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-gold transition-colors rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                Wertanalyse
              </a>
            </div>
          </div>

          <a href="/blog" class="block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
            Blog
          </a>
          <a href="#uber-mich" class="block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
            Über mich
          </a>
          <a href="#kontakt" class="block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-primary-gold dark:hover:text-primary-gold transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
            Kontakt
          </a>
        </nav>
      </div>
    </div>
  </div>
</header>

<style>
  /* USER CHOICE TOGGLE SYSTEM CSS */
  
  /* Force Mobile Mode */
  .force-mobile-mode .hidden.lg\:flex {
    display: none !important;
  }
  
  .force-mobile-mode .lg\:hidden {
    display: flex !important;
  }
  
  .force-mobile-mode .services-desktop-grid,
  .force-mobile-mode .value-desktop-grid,
  .force-mobile-mode .process-desktop-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 1rem !important;
  }

  /* Force Desktop Mode */
  .force-desktop-mode .lg\:hidden {
    display: none !important;
  }
  
  .force-desktop-mode .hidden.lg\:flex {
    display: flex !important;
  }
  
  .force-desktop-mode .services-desktop-grid,
  .force-desktop-mode .value-desktop-grid,
  .force-desktop-mode .process-desktop-grid {
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 2rem !important;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log('🎨 Header v1.7.1 - SAUBERE User Choice Integration');
  
  // === USER CHOICE TOGGLE SYSTEM ===
  const userChoiceToggle = document.getElementById('user-choice-toggle');
  const userChoiceToggleMobile = document.getElementById('user-choice-toggle-mobile');
  const userChoiceIcon = document.getElementById('user-choice-icon');
  const userChoiceText = document.getElementById('user-choice-text');
  
  // User Choice Modi
  const userChoiceModes = ['auto', 'mobile', 'desktop'];
  let currentUserChoice = localStorage.getItem('userChoice') || 'auto';
  
  console.log('🔧 Current User Choice:', currentUserChoice);
  
  // User Choice Icons
  const userChoiceIcons = {
    auto: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>',
    mobile: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>',
    desktop: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>'
  };
  
  function updateUserChoiceUI() {
    if (userChoiceIcon && userChoiceText) {
      userChoiceIcon.innerHTML = userChoiceIcons[currentUserChoice];
      userChoiceText.textContent = currentUserChoice.charAt(0).toUpperCase() + currentUserChoice.slice(1);
    }
    console.log('🎯 User Choice UI updated:', currentUserChoice);
  }
  
  function applyUserChoice() {
    // Alle Classes entfernen
    document.body.classList.remove('force-mobile-mode', 'force-desktop-mode');
    
    // User Choice anwenden
    switch(currentUserChoice) {
      case 'mobile':
        document.body.classList.add('force-mobile-mode');
        console.log('📱 FORCE MOBILE MODE ACTIVATED');
        break;
      case 'desktop':
        document.body.classList.add('force-desktop-mode');
        console.log('🖥️ FORCE DESKTOP MODE ACTIVATED');
        break;
      case 'auto':
      default:
        console.log('🔄 AUTO MODE ACTIVATED (Responsive)');
        break;
    }
    
    updateUserChoiceUI();
  }
  
  function toggleUserChoice() {
    const currentIndex = userChoiceModes.indexOf(currentUserChoice);
    const nextIndex = (currentIndex + 1) % userChoiceModes.length;
    currentUserChoice = userChoiceModes[nextIndex];
    
    localStorage.setItem('userChoice', currentUserChoice);
    console.log('🔄 User Choice Toggle:', currentUserChoice);
    
    applyUserChoice();
    
    // Page Reload für sofortige Anwendung
    setTimeout(() => {
      console.log('🔄 Reloading page for User Choice application...');
      window.location.reload();
    }, 100);
  }
  
  // Event Listeners für User Choice Toggle
  if (userChoiceToggle) {
    userChoiceToggle.addEventListener('click', toggleUserChoice);
  }
  
  if (userChoiceToggleMobile) {
    userChoiceToggleMobile.addEventListener('click', toggleUserChoice);
  }
  
  // Initial User Choice anwenden
  applyUserChoice();
  
  // === MOBILE MENU TOGGLE ===
  const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');
  
  if (mobileMenuToggle && mobileMenu) {
    mobileMenuToggle.addEventListener('click', function() {
      mobileMenu.classList.toggle('hidden');
      console.log('📱 Mobile menu toggled');
    });
  }

  // === MOBILE SERVICES ACCORDION ===
  const mobileLeistungenToggle = document.getElementById('mobile-leistungen-toggle');
  const mobileLeistungenMenu = document.getElementById('mobile-leistungen-menu');
  const mobileLeistungenArrow = document.getElementById('mobile-leistungen-arrow');
  
  if (mobileLeistungenToggle && mobileLeistungenMenu && mobileLeistungenArrow) {
    mobileLeistungenToggle.addEventListener('click', function() {
      mobileLeistungenMenu.classList.toggle('hidden');
      mobileLeistungenArrow.classList.toggle('rotate-180');
      console.log('📋 Mobile services accordion toggled');
    });
  }

  // === THEME TOGGLE SYSTEM ===
  const themeToggle = document.getElementById('theme-toggle');
  const themeToggleMobile = document.getElementById('theme-toggle-mobile');
  const darkIcon = document.getElementById('theme-toggle-dark-icon');
  const lightIcon = document.getElementById('theme-toggle-light-icon');
  const darkIconMobile = document.getElementById('theme-toggle-dark-icon-mobile');
  const lightIconMobile = document.getElementById('theme-toggle-light-icon-mobile');

  function updateThemeIcons() {
    const isDark = document.documentElement.classList.contains('dark');
    console.log('🌙 Theme Icons Update - Dark Mode:', isDark);
    
    if (isDark) {
      darkIcon?.classList.add('hidden');
      lightIcon?.classList.remove('hidden');
      darkIconMobile?.classList.add('hidden');
      lightIconMobile?.classList.remove('hidden');
    } else {
      darkIcon?.classList.remove('hidden');
      lightIcon?.classList.add('hidden');
      darkIconMobile?.classList.remove('hidden');
      lightIconMobile?.classList.add('hidden');
    }
  }

  function toggleTheme() {
    if (document.documentElement.classList.contains('dark')) {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('theme', 'light');
      console.log('☀️ Light Theme Activated');
    } else {
      document.documentElement.classList.add('dark');
      localStorage.setItem('theme', 'dark');
      console.log('🌙 Dark Theme Activated');
    }
    updateThemeIcons();
  }

  // Theme Toggle Event Listeners
  themeToggle?.addEventListener('click', toggleTheme);
  themeToggleMobile?.addEventListener('click', toggleTheme);

  // Initial Theme Icons
  updateThemeIcons();

  console.log('✅ Header v1.7.1 - All systems initialized successfully!');
});
</script>