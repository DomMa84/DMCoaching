---
// src/components/ServiceCard.astro v1.0 (Server-Mode & Business optimiert)
// Service Card Component - SEO & Conversion optimiert

// âœ… WICHTIG: Komponenten brauchen kein prerender - automatisch statisch im Server-Mode

import IconSVG from './IconSVG.astro';

interface Props {
  title: string;
  description: string;
  iconPath: string;
  link: string;
  delay?: number;
  variant?: "default" | "featured" | "compact";
  badge?: string; // z.B. "Neu", "Beliebt", "Premium"
  price?: string; // Preisangabe optional
  features?: string[]; // Feature-Liste
  cta?: string; // Custom Call-to-Action
  external?: boolean; // Externer Link
  priority?: "high" | "normal" | "low"; // SEO Priority
  schema?: boolean; // Schema.org Markup
  testimonial?: { quote: string; author: string }; // Mini-Testimonial
}

const { 
  title, 
  description, 
  iconPath, 
  link,
  delay = 100,
  variant = "default",
  badge,
  price,
  features = [],
  cta = "Mehr erfahren",
  external = false,
  priority = "normal",
  schema = true,
  testimonial
} = Astro.props;

// Variant-spezifische Klassen
const variantClasses = {
  default: "bg-light-darker dark:bg-dark-lighter rounded-lg p-5 md:p-6",
  featured: "bg-white dark:bg-dark rounded-lg shadow-lg p-6 md:p-8 border-2 border-primary-gold/30 relative overflow-hidden",
  compact: "bg-light-darker dark:bg-dark-lighter rounded-lg p-4 md:p-5"
};

// Icon-Container GrÃ¶ÃŸen basierend auf Variante
const iconSizes = {
  default: { container: "p-3 md:p-4", icon: "w-8 h-8 md:w-10 md:h-10" },
  featured: { container: "p-4 md:p-5", icon: "w-10 h-10 md:w-12 md:h-12" },
  compact: { container: "p-3", icon: "w-6 h-6 md:w-8 md:h-8" }
};

const cardClasses = variantClasses[variant];
const iconConfig = iconSizes[variant];

// SEO-optimierte Card-ID
const cardId = `service-${title.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '')}`;

// Link-Attribute fÃ¼r SEO
const linkAttributes = {
  href: link,
  ...(external && { target: "_blank", rel: "noopener noreferrer" }),
  ...(priority === "high" && { "data-priority": "high" })
};

console.log(`ðŸ’¼ ServiceCard v1.0 loaded - Title: ${title}, Variant: ${variant}, Priority: ${priority}`);
---

<article 
  class={`${cardClasses} flex flex-col items-center text-center transition-all duration-300 hover:transform hover:scale-105 hover:shadow-xl group relative`}
  data-aos="fade-up"
  data-aos-delay={delay}
  id={cardId}
  itemscope={schema ? true : undefined}
  itemtype={schema ? "https://schema.org/Service" : undefined}
>
  <!-- Featured Badge -->
  {badge && (
    <div class="absolute top-3 right-3 z-10">
      <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-gold text-white shadow-sm">
        {badge}
      </span>
    </div>
  )}
  
  <!-- Featured Background Effect -->
  {variant === "featured" && (
    <div class="absolute inset-0 bg-gradient-to-br from-primary-gold/5 via-transparent to-primary-gold/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300" aria-hidden="true"></div>
  )}
  
  <!-- Icon Container -->
  <div class={`bg-primary-gold/10 ${iconConfig.container} rounded-full mb-4 md:mb-6 group-hover:bg-primary-gold/20 transition-all duration-300 relative z-10`}>
    <IconSVG 
      iconPath={iconPath} 
      className={`${iconConfig.icon} text-primary-gold group-hover:text-primary-gold/90 transition-colors duration-300`}
      ariaLabel={`${title} Service Icon`}
    />
  </div>
  
  <!-- Content Container -->
  <div class="flex-1 flex flex-col relative z-10">
    <!-- Title -->
    <h3 
      class={`font-semibold mb-3 md:mb-4 text-text-dark dark:text-text-light leading-tight group-hover:text-primary-gold transition-colors duration-300 ${
        variant === "compact" ? "text-lg" : variant === "featured" ? "text-xl md:text-2xl" : "text-lg md:text-xl"
      }`}
      itemprop={schema ? "name" : undefined}
    >
      {title}
    </h3>
    
    <!-- Price (if provided) -->
    {price && (
      <div class="mb-3">
        <span 
          class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-primary-gold/10 text-primary-gold"
          itemprop={schema ? "offers" : undefined}
          itemscope={schema ? true : undefined}
          itemtype={schema ? "https://schema.org/Offer" : undefined}
        >
          <span itemprop={schema ? "price" : undefined}>{price}</span>
        </span>
      </div>
    )}
    
    <!-- Description -->
    <p 
      class={`text-text-muted leading-relaxed mb-4 md:mb-6 ${variant === "compact" ? "text-sm" : "text-sm md:text-base"}`}
      itemprop={schema ? "description" : undefined}
    >
      {description}
    </p>
    
    <!-- Features List -->
    {features.length > 0 && (
      <ul class="text-left mb-4 md:mb-6 space-y-2">
        {features.map(feature => (
          <li class="flex items-start text-sm text-text-muted">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-primary-gold mr-2 mt-0.5 flex-shrink-0">
              <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
            </svg>
            <span>{feature}</span>
          </li>
        ))}
      </ul>
    )}
    
    <!-- Mini-Testimonial -->
    {testimonial && (
      <blockquote class="mb-4 md:mb-6 p-3 bg-primary-gold/5 rounded-lg italic text-sm text-text-dark dark:text-text-light border-l-2 border-primary-gold">
        <p class="mb-1">"{testimonial.quote}"</p>
        <cite class="text-xs text-text-muted not-italic">â€” {testimonial.author}</cite>
      </blockquote>
    )}
    
    <!-- CTA Button/Link -->
    <a 
      {...linkAttributes}
      class={`text-primary-gold font-medium hover:text-primary-gold/80 transition-all duration-300 mt-auto inline-flex items-center group-hover:underline ${
        variant === "compact" ? "text-sm" : "text-sm md:text-base"
      }`}
      aria-label={`${cta} - ${title}`}
      itemprop={schema ? "url" : undefined}
    >
      <span>{cta}</span>
      <svg 
        xmlns="http://www.w3.org/2000/svg" 
        viewBox="0 0 20 20" 
        fill="currentColor" 
        class="w-4 h-4 md:w-5 md:h-5 ml-1 group-hover:translate-x-1 transition-transform duration-300" 
        aria-hidden="true"
      >
        <path fill-rule="evenodd" d="M5 10a.75.75 0 01.75-.75h6.638L10.23 7.29a.75.75 0 111.04-1.08l3.5 3.25a.75.75 0 010 1.08l-3.5 3.25a.75.75 0 11-1.04-1.08l2.158-1.96H5.75A.75.75 0 015 10z" clip-rule="evenodd" />
      </svg>
      
      {external && (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3 ml-1 opacity-60">
          <path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0112.75 17h-8.5A2.25 2.25 0 012 14.75v-8.5A2.25 2.25 0 014.25 4h5a.75.75 0 010 1.5h-5z" clip-rule="evenodd" />
          <path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 001.06.053L16.5 4.44v2.81a.75.75 0 001.5 0v-4.5a.75.75 0 00-.75-.75h-4.5a.75.75 0 000 1.5h2.553l-9.056 8.194a.75.75 0 00-.053 1.06z" clip-rule="evenodd" />
        </svg>
      )}
    </a>
  </div>
  
  <!-- Schema.org zusÃ¤tzliche Metadaten (versteckt) -->
  {schema && (
    <div class="sr-only">
      <span itemprop="serviceType">Unternehmensberatung</span>
      <span itemprop="provider" itemscope itemtype="https://schema.org/Organization">
        <span itemprop="name">Dominik Maier Coaching & Interim Management</span>
      </span>
      <span itemprop="areaServed">Baden-WÃ¼rttemberg</span>
      <span itemprop="category">Business Consulting</span>
    </div>
  )}
</article>

<style>
  /* Card Base Styles */
  article {
    position: relative;
    overflow: hidden;
  }
  
  /* Hover-Effekt mit Sweep-Animation */
  article::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.08), transparent);
    transition: left 0.6s ease;
    z-index: 0;
  }
  
  article:hover::before {
    left: 100%;
  }
  
  /* Featured Card Spezialeffekte */
  .group:hover .bg-gradient-to-br {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.08), rgba(212, 175, 55, 0.12));
  }
  
  /* Features List Styling */
  ul {
    max-width: 100%;
  }
  
  /* Testimonial Styling */
  blockquote {
    position: relative;
  }
  
  blockquote::before {
    content: '"';
    position: absolute;
    top: -8px;
    left: -4px;
    font-size: 2rem;
    color: var(--primary-gold, #D4AF37);
    opacity: 0.3;
    line-height: 1;
  }
  
  /* Responsive Design */
  @media (max-width: 768px) {
    article {
      padding: 1rem;
    }
    
    .bg-gradient-to-br {
      display: none; /* Vereinfachung auf Mobile */
    }
  }
  
  /* Accessibility - Reduced Motion */
  @media (prefers-reduced-motion: reduce) {
    article {
      transition: none;
    }
    
    article:hover {
      transform: none;
      scale: 1;
    }
    
    article::before {
      display: none;
    }
    
    .group-hover\\:translate-x-1 {
      transform: none !important;
    }
  }
  
  /* Focus States fÃ¼r Accessibility */
  article:focus-within {
    outline: 2px solid #D2AE6C;
    outline-offset: 2px;
  }
  
  a:focus {
    outline: 2px solid #D2AE6C;
    outline-offset: 2px;
    border-radius: 0.25rem;
  }
  
  /* Dark Mode Optimierungen */
  @media (prefers-color-scheme: dark) {
    article {
      border: 1px solid rgba(212, 175, 55, 0.1);
    }
    
    article:hover {
      border-color: rgba(212, 175, 55, 0.2);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
    }
    
    blockquote {
      background-color: rgba(212, 175, 55, 0.08);
    }
  }
  
  /* Print Styles */
  @media print {
    article {
      break-inside: avoid;
      box-shadow: none;
      border: 1px solid #ccc;
    }
    
    article::before {
      display: none;
    }
    
    .group-hover\\:translate-x-1 {
      transform: none;
    }
  }
  
  /* High Contrast Mode */
  @media (prefers-contrast: high) {
    article {
      border: 2px solid currentColor;
    }
    
    .bg-primary-gold\\/10 {
      background-color: rgba(212, 175, 55, 0.25);
    }
  }
  
  /* Screen Reader Only Content */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
  
  /* Footer version info */
  .footer-version::after {
    content: "ServiceCard v1.0 - Server-Mode & Business optimiert";
  }
</style>